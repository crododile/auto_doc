<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>Api Docs</title>
    <script type="text/javascript">
      function prettyPrintJson() {
        var jsonNodes = document.getElementsByClassName("json");
        for (i = 0; i < jsonNodes.length; i++) {
            var json = JSON.parse(jsonNodes[i].innerText);
            jsonNodes[i].innerText = JSON.stringify(json, null, 2);
            jsonNodes[i].className = jsonNodes[i].className + " prettyprint";
        }
      }
    </script>

    <style media="screen">
      .test-case {
        border: solid black 1px;
        padding: 10px;
        margin: 10px;
      }
      .json {
        white-space: pre;
      }
    </style>
    
  </head>
  <body onload="prettyPrintJson()">
    <h1>API Docs</h1>
    <div class="test-cases">
      <%= for test <- tests do %>
        <div class="test-case">
          <p class="name">
            <%= test.test_name %>
          </p>
          <div class="request">
            <p>
              <%= test.request.method %> <%= test.request.path %>
            </p>
            <h3>Headers</h3>
            <%= for headers <- test.request.headers do %>
            <p>
              <code>
                <%= Enum.join(Tuple.to_list(headers), ": ") %>
              </code>
            </p>
            <% end %>
            <h3>Params</h3>
            <p>
              <code class="json">
                <%= Poison.encode!(test.request.params) %>
              </code>
            </p>
          </div>
          <div class="response">
            <h3>Status</h3>
            <p>
              <code>
                <%= test.response.status %>
              </code>
            </p>
            <h3>Response</h3>
            <code class="json">
              <%= test.response.body %>
            </code>
          </div>
        </div>
      <% end %>
    </div>
  </body>
</html>
